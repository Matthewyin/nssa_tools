<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MLG æ¶ˆé™¤é€»è¾‘ä¿®å¤æµ‹è¯•</title>
  <style>
    body { font-family: monospace; padding: 20px; background: #f5f5f5; }
    .test-case { background: white; margin: 10px 0; padding: 15px; border-radius: 8px; border-left: 4px solid #007acc; }
    .result { margin: 10px 0; padding: 10px; border-radius: 4px; }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    .info { background: #d1ecf1; color: #0c5460; }
    .slot-display { display: flex; gap: 5px; margin: 10px 0; }
    .slot-item { width: 40px; height: 40px; border: 2px solid #ccc; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
    button { padding: 8px 16px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
    .btn-test { background: #007acc; color: white; }
    .btn-reset { background: #6c757d; color: white; }
  </style>
</head>
<body>
  <h1>MLG æ¶ˆé™¤é€»è¾‘ä¿®å¤æµ‹è¯•</h1>
  <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•MLGæ¸¸æˆä¸­æ§½ä½æ¶ˆé™¤é€»è¾‘çš„ä¿®å¤æ•ˆæœã€‚</p>

  <div class="test-case">
    <h3>æµ‹è¯•åœºæ™¯ï¼šæ§½ä½ä¸­æœ‰4ä¸ªç›¸åŒå›¾æ ‡</h3>
    <div id="test-slot" class="slot-display">
      <div class="slot-item">ğŸ±</div>
      <div class="slot-item">ğŸ±</div>
      <div class="slot-item">ğŸ±</div>
      <div class="slot-item">ğŸ±</div>
      <div class="slot-item" style="border-style: dashed; color: #ccc;">ç©º</div>
      <div class="slot-item" style="border-style: dashed; color: #ccc;">ç©º</div>
      <div class="slot-item" style="border-style: dashed; color: #ccc;">ç©º</div>
      <div class="slot-item" style="border-style: dashed; color: #ccc;">ç©º</div>
    </div>
    <button class="btn-test" onclick="testElimination()">æµ‹è¯•æ¶ˆé™¤é€»è¾‘</button>
    <button class="btn-reset" onclick="resetTest()">é‡ç½®æµ‹è¯•</button>
    <div id="test-result" class="result info">ç‚¹å‡»"æµ‹è¯•æ¶ˆé™¤é€»è¾‘"æŒ‰é’®å¼€å§‹æµ‹è¯•</div>
  </div>

  <div class="test-case">
    <h3>ä¿®å¤è¯´æ˜</h3>
    <div class="result info">
      <strong>é—®é¢˜åŸå› ï¼š</strong><br>
      1. åŸæ¥çš„æ¶ˆé™¤é€»è¾‘åªåœ¨æ·»åŠ æ–°tileæ—¶æ£€æŸ¥<br>
      2. æ’¤é”€æ“ä½œåæ²¡æœ‰é‡æ–°æ£€æŸ¥æ¶ˆé™¤é€»è¾‘<br>
      3. å¯èƒ½å¯¼è‡´æ§½ä½ä¸­å‡ºç°è¶…è¿‡3ä¸ªç›¸åŒç±»å‹çš„æƒ…å†µ<br><br>
      
      <strong>ä¿®å¤æ–¹æ¡ˆï¼š</strong><br>
      1. åˆ›å»ºç‹¬ç«‹çš„ <code>checkSlotElimination()</code> å‡½æ•°<br>
      2. åœ¨æ’¤é”€æ“ä½œåè°ƒç”¨æ¶ˆé™¤æ£€æŸ¥<br>
      3. åœ¨æ¸¸æˆåŠ è½½æ—¶ä¹Ÿæ£€æŸ¥å¹¶ä¿®å¤æ§½ä½çŠ¶æ€<br>
      4. æ”¯æŒè¿ç»­æ¶ˆé™¤ï¼Œç›´åˆ°æ²¡æœ‰å¯æ¶ˆé™¤çš„ç»„åˆ<br><br>
      
      <strong>æµ‹è¯•æ–¹æ³•ï¼š</strong><br>
      1. æ¨¡æ‹Ÿæ§½ä½ä¸­æœ‰4ä¸ªç›¸åŒå›¾æ ‡çš„æƒ…å†µ<br>
      2. è°ƒç”¨æ¶ˆé™¤é€»è¾‘å‡½æ•°<br>
      3. éªŒè¯æ˜¯å¦æ­£ç¡®æ¶ˆé™¤äº†3ä¸ªï¼Œå‰©ä½™1ä¸ª
    </div>
  </div>

  <script>
    // æ¨¡æ‹ŸMLGæ¸¸æˆçš„æ¶ˆé™¤é€»è¾‘
    function checkSlotElimination(slot, tiles) {
      let hasElimination = true;
      const eliminated = [];
      
      // æŒç»­æ£€æŸ¥ç›´åˆ°æ²¡æœ‰å¯æ¶ˆé™¤çš„ç»„åˆ
      while (hasElimination) {
        hasElimination = false;
        
        // ç»Ÿè®¡æ¯ç§ç±»å‹çš„æ•°é‡
        const typeCount = {};
        slot.forEach(id => {
          const tile = tiles.find(t => t.id === id);
          if (tile) {
            typeCount[tile.type] = (typeCount[tile.type] || 0) + 1;
          }
        });
        
        // æ£€æŸ¥æ˜¯å¦æœ‰ç±»å‹æ•°é‡ >= 3
        for (const [type, count] of Object.entries(typeCount)) {
          if (count >= 3) {
            hasElimination = true;
            
            // æ‰¾åˆ°è¯¥ç±»å‹çš„å‰3ä¸ªtileå¹¶ç§»é™¤
            const toRemove = [];
            for (const id of slot) {
              const tile = tiles.find(t => t.id === id);
              if (tile && tile.type === parseInt(type)) {
                toRemove.push(id);
                if (toRemove.length === 3) break;
              }
            }
            
            // ä»æ§½ä½ä¸­ç§»é™¤
            slot = slot.filter(id => !toRemove.includes(id));
            eliminated.push(...toRemove);
            
            // åªå¤„ç†ä¸€ç§ç±»å‹ï¼Œç„¶åé‡æ–°å¼€å§‹å¾ªç¯
            break;
          }
        }
      }
      
      return { slot, eliminated };
    }
    
    function testElimination() {
      // æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®
      const tiles = [
        { id: 1, type: 1 }, // ğŸ±
        { id: 2, type: 1 }, // ğŸ±
        { id: 3, type: 1 }, // ğŸ±
        { id: 4, type: 1 }, // ğŸ±
      ];
      
      let slot = [1, 2, 3, 4]; // 4ä¸ªç›¸åŒçš„å›¾æ ‡
      
      const resultEl = document.getElementById('test-result');
      resultEl.innerHTML = `
        <strong>æµ‹è¯•å¼€å§‹ï¼š</strong><br>
        åˆå§‹æ§½ä½ï¼š[${slot.join(', ')}] (4ä¸ªç›¸åŒå›¾æ ‡)<br>
        <br>
        æ‰§è¡Œæ¶ˆé™¤é€»è¾‘...<br>
      `;
      
      setTimeout(() => {
        const result = checkSlotElimination(slot, tiles);
        
        const success = result.slot.length === 1 && result.eliminated.length === 3;
        
        resultEl.className = `result ${success ? 'success' : 'error'}`;
        resultEl.innerHTML += `
          <strong>æµ‹è¯•ç»“æœï¼š</strong><br>
          æ¶ˆé™¤åæ§½ä½ï¼š[${result.slot.join(', ')}]<br>
          è¢«æ¶ˆé™¤çš„ï¼š[${result.eliminated.join(', ')}]<br>
          <br>
          <strong>${success ? 'âœ… æµ‹è¯•é€šè¿‡' : 'âŒ æµ‹è¯•å¤±è´¥'}ï¼š</strong>
          ${success ? 'æ­£ç¡®æ¶ˆé™¤äº†3ä¸ªï¼Œå‰©ä½™1ä¸ª' : 'æ¶ˆé™¤é€»è¾‘æœ‰é—®é¢˜'}
        `;
        
        // æ›´æ–°å¯è§†åŒ–æ˜¾ç¤º
        updateSlotDisplay(result.slot);
      }, 500);
    }
    
    function updateSlotDisplay(slot) {
      const slotEl = document.getElementById('test-slot');
      const items = slotEl.children;
      
      for (let i = 0; i < items.length; i++) {
        if (i < slot.length) {
          items[i].textContent = 'ğŸ±';
          items[i].style.borderStyle = 'solid';
          items[i].style.color = 'black';
        } else {
          items[i].textContent = 'ç©º';
          items[i].style.borderStyle = 'dashed';
          items[i].style.color = '#ccc';
        }
      }
    }
    
    function resetTest() {
      const resultEl = document.getElementById('test-result');
      resultEl.className = 'result info';
      resultEl.textContent = 'ç‚¹å‡»"æµ‹è¯•æ¶ˆé™¤é€»è¾‘"æŒ‰é’®å¼€å§‹æµ‹è¯•';
      
      // é‡ç½®æ˜¾ç¤º
      const slotEl = document.getElementById('test-slot');
      const items = slotEl.children;
      
      for (let i = 0; i < items.length; i++) {
        if (i < 4) {
          items[i].textContent = 'ğŸ±';
          items[i].style.borderStyle = 'solid';
          items[i].style.color = 'black';
        } else {
          items[i].textContent = 'ç©º';
          items[i].style.borderStyle = 'dashed';
          items[i].style.color = '#ccc';
        }
      }
    }
  </script>
</body>
</html>
